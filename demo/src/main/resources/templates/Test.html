<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css"
/>
<script
            src="https://code.jquery.com/jquery-3.4.1.min.js"
            integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
            crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=48971b76634343c42ebd862e6da068cd"></script>



<title>Insert title here</title>
<style>
	body{
		font-family: 'Jua', sans-serif;
		
		width: 200px;
	}
	
	header{
		background-color: rgb(255, 253, 239);
		font-size: 32px;
	
		
	}
	
	.tmp{
		font-size: 64px;
	}
	.swiper {
	  background-color: rgb(255, 255, 255);
	  height: 300px;
	}
	
	.swiper-slide{
		overflow: auto;
		font-size: 12px;
	} 
	.swiper-slide::-webkit-scrollbar {
	    width: 0.1px;  /* 스크롤바의 너비 */
	}
	
	.swiper-slide::-webkit-scrollbar-thumb {
	    height: 30%; /* 스크롤바의 길이 */
	    background: #217af4; /* 스크롤바의 색상 */
	    
	    border-radius: 20px;
	}
	
	.swiper-slide::-webkit-scrollbar-track {
	    background: rgba(33, 122, 244, .1);  /*스크롤바 뒷 배경 색상*/
	}
	
	thead{
		font-size:40px;
	}
	
	/*
	.swiper-pagination-bullet { width: 100%; min-height: 20px; background: transparent; opacity: 1;  float: left; width: 30%; }
	*/

	.swiper-pagination-bullet {margin-bottom: 15px !important; } 

	.fixed{

		width: 500px;
		
	}




		

</style>


</head>
<body class="container w-25">
	<div class="fixed">
	<header class="mt-5 text-center">
		오늘 날씨 어때?
	</header>
	<article class="mt-5">	
		<div style="float:left; margin-right:20%; ">	
		<div class="tmp" style="width:200px;" >
			<!-- 현재시간의 온도 뽑기 -->
			<tr th:each="sb : ${sb}">
			  <!-- 
			   <td th:if="${sb.category} == TMP and ${sb.fcstTime} == ${nowTime} and ${sb.fcstDate} == ${simToday}" th:text="${sb.fcstDate}"></td>
			    
			   <td th:if="${sb.category} == TMP and ${sb.fcstTime} == ${nowTime} and ${sb.fcstDate} == ${simToday}" th:text="${sb.category}"></td>
			   <td th:if="${sb.category} == TMP and ${sb.fcstTime} == ${nowTime} and ${sb.fcstDate} == ${simToday}" th:text="${sb.fcstTime}"></td>
			   -->
			   <a id="dhseh" th:if="${sb.category} == TMP and ${sb.fcstTime} == ${nowTime} and ${sb.fcstDate} == ${simToday}" style="float:left; ">[[${sb.fcstValue}]]</a>
			</tr>
			<div>
			<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-circle" viewBox="0 0 16 16" style="margin-bottom:50px; ">
			  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
			</svg>
			</div>
			
			
		</div>
		<div>
			
			<a id="high">14</a>
			<svg xmlns="http://www.w3.org/2000/svg" width="6" height="16" fill="currentColor" class="bi bi-circle" viewBox="0 0 16 16" style="margin-bottom:10px; margin-left:-5px ">
			  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
			</svg>
			/
			<a id="low">3</a>
			<svg xmlns="http://www.w3.org/2000/svg" width="6" height="16" fill="currentColor" class="bi bi-circle" viewBox="0 0 16 16" style="margin-bottom:10px; margin-left:-5px ">
			  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
			</svg>
		</div>
		<div>
			태평로 2가
		</div>
		<div>
			습도 : 55%
		</div>
		<div>
			<p th:text="${todayTime}">
		</div>
		</div>
		
		<div id="map" style="width:200px;height:200px;"></div>
	
		
	</article>
	
	<div>
		<div class="" style="text-align: center;">
			위치
		</div>
		<div class="" style="font-size: 32px;">
			기온 및 날씨
		</div>
		<div class="mt-3 swiper01">
			
			<!-- 오늘 -->
			<div class="swiper border border-3 rounded">
			
			  <!-- Additional required wrapper -->
			  <div class="swiper-wrapper" id="swiper-wrapper">
			    <!-- Slides -->
			    <div class="swiper-slide" >
			  		<div class="mt-3 mb-3" style="font-size: 20px; text-align: center;">오늘의 날씨</div>
	    			<table class="table">
						
						<tbody >
					
						<tr>
						   <td th:each="sb : ${sb}" th:if="${sb.category} == TMP and ${sb.fcstTime} >= ${nowTime} and ${sb.fcstDate} == ${simToday}" th:text="${sb.fcstValue} + 도"></td>
		
						</tr>
						<tr style="font-size: 12px;">
					   		<td th:each="sb : ${sb}" th:if="${sb.category} == TMP and ${sb.fcstTime} >= ${nowTime} and ${sb.fcstDate} == ${simToday}" th:text="${sb.fcstTime}"></td>
						</tr>
						</tbody>
					</table>
				
			    </div>
			    <div class="swiper-slide" data-type="내일">
					<div class="mt-3 mb-3" style="font-size: 20px; text-align: center;">내일의 날씨</div>
					<table class="table">

						<tbody>
						<tr>
						   <td th:each="sb : ${sb}" th:if="${sb.category} == TMP  and ${sb.fcstDate} == ${simToday} +1" th:text="${sb.fcstValue} + 도"></td>
		
						</tr>
						<tr style="font-size: 12px;">
					   		<td th:each="sb : ${sb}" th:if="${sb.category} == TMP and ${sb.fcstDate} == ${simToday} +1" th:text="${sb.fcstTime}"></td>
						</tr>
						</tbody>
					</table>
			    </div>
			    <div class="swiper-slide">
				   <div class="mt-3 mb-3" style="font-size: 20px; text-align: center;">모레의 날씨</div>
				    <table class="table">
						
						<tbody>
						<tr>
						   <td th:each="sb : ${sb}" th:if="${sb.category} == TMP  and ${sb.fcstDate} == ${simToday} +2" th:text="${sb.fcstValue} + 도"></td>
		
						</tr>
						<tr style="font-size: 12px;">
					   		<td th:each="sb : ${sb}" th:if="${sb.category} == TMP and ${sb.fcstDate} == ${simToday} +2" th:text="${sb.fcstTime}"></td>
						</tr>
						</tbody>
					</table>
			    </div>
			   
			  </div>

				<div class="swiper-pagination"></div>
			</div>

		</div>
	</div>
	
	
	</div>



	
	<script>

	
	var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
    mapOption = { 
        center: new kakao.maps.LatLng(37.57037777777778, 126.98164166666668), // 지도의 중심좌표
        level: 3 // 지도의 확대 레벨
    };

	var map = new kakao.maps.Map(mapContainer, mapOption); // 지도를 생성합니다
	
	// 지도를 클릭한 위치에 표출할 마커입니다
	var marker = new kakao.maps.Marker({ 
	    // 지도 중심좌표에 마커를 생성합니다 
	    position: map.getCenter() 
	}); 
	// 지도에 마커를 표시합니다
	marker.setMap(map);
	
	// 지도에 클릭 이벤트를 등록합니다
	// 지도를 클릭하면 마지막 파라미터로 넘어온 함수를 호출합니다
	kakao.maps.event.addListener(map, 'click', function(mouseEvent) {        
	    
	    // 클릭한 위도, 경도 정보를 가져옵니다 
	    var latlng = mouseEvent.latLng; 
	    
	    // 마커 위치를 클릭한 위치로 옮깁니다
	    marker.setPosition(latlng);
	    
	    //ajax를 이용해서 실시간으로 값바꿔주기...!!
	    
		var getLat = latlng.getLat();
	    var getLng = latlng.getLng();

	    var xy = dfs_xy_conv("toXY", latlng.getLat(), latlng.getLng());
		
	    
	    $.ajax({
            url:'test',
            type:'post',
            data:{getLat: xy.x, getLng: xy.y},
            dataType: "json",
            success:function(data){ 
            	if(data.code === "success"){
            		
            	}
            	
            	var message = data.fcstValue;
            	
            	var div = document.getElementById('dhseh');
            	div.innerHTML = message + '';
            	
            	var high = document.getElementById('high');
            	high.innerHTML = data.highValue;
            	
            	var low = document.getElementById('low');
            	low.innerHTML = data.lowValue;
       		
            	
            
            
            }
			});


	    
	});
	
	
	
	   //----------------------------------------------------------
	    // 기상청 홈페이지에서 발췌한 변환 함수
	    //
	    // LCC DFS 좌표변환을 위한 기초 자료
	    //
	    var RE = 6371.00877; // 지구 반경(km)
	    var GRID = 5.0; // 격자 간격(km)
	    var SLAT1 = 30.0; // 투영 위도1(degree)
	    var SLAT2 = 60.0; // 투영 위도2(degree)
	    var OLON = 126.0; // 기준점 경도(degree)
	    var OLAT = 38.0; // 기준점 위도(degree)
	    var XO = 43; // 기준점 X좌표(GRID)
	    var YO = 136; // 기1준점 Y좌표(GRID)

	// LCC DFS 좌표변환 ( code : 
//	          "toXY"(위경도->좌표, v1:위도, v2:경도), 
//	          "toLL"(좌표->위경도,v1:x, v2:y) )
	//

	    function dfs_xy_conv(code, v1, v2) {
	        var DEGRAD = Math.PI / 180.0;
	        var RADDEG = 180.0 / Math.PI;
	        
	        var re = RE / GRID;
	        var slat1 = SLAT1 * DEGRAD;
	        var slat2 = SLAT2 * DEGRAD;
	        var olon = OLON * DEGRAD;
	        var olat = OLAT * DEGRAD;
	        
	        var sn = Math.tan(Math.PI * 0.25 + slat2 * 0.5) / Math.tan(Math.PI * 0.25 + slat1 * 0.5);
	        sn = Math.log(Math.cos(slat1) / Math.cos(slat2)) / Math.log(sn);
	        var sf = Math.tan(Math.PI * 0.25 + slat1 * 0.5);
	        sf = Math.pow(sf, sn) * Math.cos(slat1) / sn;
	        var ro = Math.tan(Math.PI * 0.25 + olat * 0.5);
	        ro = re * sf / Math.pow(ro, sn);
	        var rs = {};
	        if (code == "toXY") {
	            rs['lat'] = v1;
	            rs['lng'] = v2;
	            var ra = Math.tan(Math.PI * 0.25 + (v1) * DEGRAD * 0.5);
	            ra = re * sf / Math.pow(ra, sn);
	            var theta = v2 * DEGRAD - olon;
	            if (theta > Math.PI) theta -= 2.0 * Math.PI;
	            if (theta < -Math.PI) theta += 2.0 * Math.PI;
	            theta *= sn;
	            rs['x'] = Math.floor(ra * Math.sin(theta) + XO + 0.5);
	            rs['y'] = Math.floor(ro - ra * Math.cos(theta) + YO + 0.5);
	        }
	        else {
	            rs['x'] = v1;
	            rs['y'] = v2;
	            var xn = v1 - XO;
	            var yn = ro - v2 + YO;
	            ra = Math.sqrt(xn * xn + yn * yn);
	            if (sn < 0.0) - ra;
	            var alat = Math.pow((re * sf / ra), (1.0 / sn));
	            alat = 2.0 * Math.atan(alat) - Math.PI * 0.5;
	            
	            if (Math.abs(xn) <= 0.0) {
	                theta = 0.0;
	            }
	            else {
	                if (Math.abs(yn) <= 0.0) {
	                    theta = Math.PI * 0.5;
	                    if (xn < 0.0) - theta;
	                }
	                else theta = Math.atan2(xn, yn);
	            }
	            var alon = theta / sn + olon;
	            rs['lat'] = alat * RADDEG;
	            rs['lng'] = alon * RADDEG;
	        }
	        return rs;
	    }


	
	

	
	
	//스위퍼 시작
	var bullet = ['오늘', '내일', '모레'];
	const swiper = new Swiper('.swiper', {
		  // Optional parameters

	
		  // If we need pagination
		  /*
		  pagination: {
		    el: '.swiper-pagination',
		    clickable: true,
		
		  },
		  */
		  pagination: {
			    el: '.swiper-pagination',
			    clickable: true,
		
			  },
		  
	
		  // And if we need scrollbar
		  scrollbar: {
		    el: '.swiper-scrollbar',
		    dynamicBullets: true,
		  },
		  
		  observer: true,
		  observeParents: true,
		});


	</script>
</body>
</html>